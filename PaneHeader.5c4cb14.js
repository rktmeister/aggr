var t=Object.defineProperty,e=(e,s,n)=>(((e,s,n)=>{s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n})(e,"symbol"!=typeof s?s+"":s,n),n);import{C as s,V as n,B as a,an as o,d as i,ao as r,A as p,F as c,n as l}from"./index.5c4cb14.js";var d=Object.defineProperty,h=Object.getOwnPropertyDescriptor;let m=class extends n{constructor(){super(...arguments),e(this,"paneId"),e(this,"_onStoreMutation")}get pane(){return this.$store.state.panes.panes[this.paneId]}mounted(){this.$el.id=this.paneId,this.refreshZoom(),this.$nextTick((()=>{const t=this.$el.clientWidth;"function"==typeof this.onResize&&this.onResize(t,this.$el.clientHeight,!0)})),this.$el.addEventListener("mousedown",this.focusPane)}beforeDestroy(){this.$el.removeEventListener("mousedown",this.focusPane),this._onStoreMutation&&this._onStoreMutation()}refreshZoom(){this.$store.dispatch("panes/refreshZoom",{id:this.paneId})}focusPane(){this.$store.commit("app/SET_FOCUSED_PANE",this.paneId)}};m=((t,e,s,n)=>{for(var a,o=n>1?void 0:n?h(e,s):e,i=t.length-1;i>=0;i--)(a=t[i])&&(o=(n?a(e,s,o):a(o))||o);return n&&o&&d(e,s,o),o})([s({props:{paneId:{required:!0,type:String}}})],m);var u=Object.defineProperty,g=Object.getOwnPropertyDescriptor;let b=class extends n{constructor(){super(...arguments),e(this,"settings"),e(this,"paneId"),e(this,"paneDropdownTrigger",null),e(this,"isLoading",!1),e(this,"isInFrame",o)}get zoom(){return this.$store.state.panes.panes[this.paneId].zoom||1}get type(){return this.$store.state.panes.panes[this.paneId].type}get syncedWithParent(){return-1!==this.$store.state.panes.syncedWithParentFrame.indexOf(this.paneId)}get name(){const t=this.$store.state.panes.panes[this.paneId].name,e=this.$store.state.panes.marketsListeners[this.$store.state.panes.panes[this.paneId].markets[0]];return t?t.trim():e?e.local:this.type}openSearch(){this.$store.dispatch("app/showSearch",{paneId:this.paneId})}changeZoom(t,e){const s=this.zoom+(t.shiftKey?.0625:.125)*e;this.$store.dispatch("panes/setZoom",{id:this.paneId,zoom:s}),this.$emit("zoom",s)}resetZoom(){this.$store.dispatch("panes/setZoom",{id:this.paneId,zoom:1}),this.$emit("zoom",1)}async removePane(){await i.confirm(`Delete pane ${this.type} "${this.name}" ?`)&&this.$store.dispatch("panes/removePane",this.paneId)}duplicatePane(){this.$store.dispatch("panes/duplicatePane",this.paneId)}maximizePane(t){if("dblclick"===t.type&&t.currentTarget!==t.target)return;const e=this.$el.parentElement.parentElement,s=e.classList.toggle("-maximized"),n=r(e);for(const o of n)o.getAttribute("type")&&(o.classList.remove("-maximized"),o.style.display=s?"none":"block");const a=Event;window.dispatchEvent(new a("resize")),this.$store.dispatch("panes/setZoom",{id:this.paneId,zoom:s?1.5*this.zoom:this.zoom*(2/3)})}async renamePane(t){t&&t.stopPropagation();const e=await i.prompt({placeholder:"Main pane's market",action:"Rename",input:this.name});"string"==typeof e&&e!==this.name&&this.$store.commit("panes/SET_PANE_NAME",{id:this.paneId,name:e})}async downloadPane(){const t=`${this.type}:${this.paneId}`;p({name:t,type:this.type,data:this.$store.state[this.paneId],markets:this.$store.state.panes.panes[this.paneId].markets,createdAt:Date.now(),updatedAt:null},c(`${this.type} ${this.name}`))}toggleDropdown(t){this.paneDropdownTrigger?this.paneDropdownTrigger=null:this.paneDropdownTrigger=t.currentTarget}async openSettings(){this.settings&&(this.isLoading=!0,i.open((await this.settings()).default,{paneId:this.paneId}),this.isLoading=!1)}};b=((t,e,s,n)=>{for(var a,o=n>1?void 0:n?g(e,s):e,i=t.length-1;i>=0;i--)(a=t[i])&&(o=(n?a(e,s,o):a(o))||o);return n&&o&&u(e,s,o),o})([s({name:"PaneHeader",props:{paneId:{type:String},settings:{type:Function,default:null},showSearch:{type:Boolean,default:!0},showName:{type:Boolean,default:!0},split:{type:Boolean,default:!0}},components:{Btn:a}})],b);const y=l(b,(function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",{staticClass:"pane-header hide-scrollbar d-flex",class:[t.split&&"pane-header--split"],on:{dblclick:t.maximizePane}},[t.showName&&t.name?e("div",{staticClass:"btn -cases pane-header__highlight",on:{dblclick:t.maximizePane}},[t._t("title",(function(){return[t._v(" "+t._s(t.name)+" "),e("btn",{staticClass:"pane-header__edit btn -text -small",attrs:{type:"button"},on:{click:t.renamePane}},[e("i",{staticClass:"icon-edit"})])]}))],2):t._e(),t._t("default",(function(){return[e("hr")]})),t.showSearch?e("button",{staticClass:"btn -text",attrs:{type:"button"},on:{click:t.openSearch}},[e("i",{staticClass:"icon-search"})]):t._e(),t.settings?e("btn",{staticClass:"pane-overlay -text",attrs:{type:"button",loading:t.isLoading},on:{click:t.openSettings}},[e("i",{staticClass:"icon-cog"})]):t._e(),e("button",{staticClass:"pane-overlay btn -text",attrs:{type:"button"},on:{click:t.toggleDropdown}},[e("i",{staticClass:"icon-more"})]),e("dropdown",{model:{value:t.paneDropdownTrigger,callback:function(e){t.paneDropdownTrigger=e},expression:"paneDropdownTrigger"}},[e("div",{staticClass:"d-flex btn-group"},[e("button",{staticClass:"btn -green",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),t.changeZoom(e,-1)}}},[e("i",{staticClass:"icon-minus"})]),e("button",{staticClass:"btn -green text-monospace flex-grow-1 text-center",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),t.resetZoom.apply(null,arguments)}}},[t._v(" Ã— "+t._s(t.zoom.toFixed(2))+" ")]),e("button",{staticClass:"btn -green",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),t.changeZoom(e,1)}}},[e("i",{staticClass:"icon-plus"})])]),null!==t.settings?e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.openSettings}},[e("i",{staticClass:"icon-cog"}),e("span",[t._v("Settings")])]):t._e(),t.showSearch?e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.openSearch}},[e("i",{staticClass:"icon-search"}),e("span",[t._v("Sources")])]):t._e(),t.isInFrame?e("div",{staticClass:"dropdown-item",on:{click:function(t){t.stopPropagation()}}},[e("label",{staticClass:"checkbox-control -small"},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.syncedWithParent},on:{change:function(e){return t.$store.commit("panes/TOGGLE_SYNC_WITH_PARENT_FRAME",t.paneId)}}}),e("div"),e("span",[t._v("Sync")])])]):t._e(),t.$slots.menu?e("div",{staticClass:"dropdown-divider",attrs:{"data-label":`${t.paneId} options`}}):t._e(),t._t("menu"),e("div",{staticClass:"dropdown-divider",attrs:{"data-label":"utilities"}}),e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.maximizePane}},[e("i",{staticClass:"icon-enlarge"}),e("span",[t._v("Maximize")])]),e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.duplicatePane}},[e("i",{staticClass:"icon-copy-paste"}),e("span",[t._v("Duplicate")])]),e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.downloadPane}},[e("i",{staticClass:"icon-download"}),e("span",[t._v("Download")])]),e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.renamePane}},[e("i",{staticClass:"icon-edit"}),e("span",[t._v("Rename")])]),e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.removePane}},[e("i",{staticClass:"icon-trash"}),e("span",[t._v("Remove")])])],2)],2)}),[],!1,null,null,null,null).exports;export{m as P,y as a};
